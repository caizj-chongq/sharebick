<!-- content start -->
<div class="admin-content">

    <div class="am-cf am-padding">
        <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">车辆管理</strong> /
            <small>编辑</small>
        </div>
    </div>

    <div class="am-tabs am-margin" data-am-tabs>
        <ul class="am-tabs-nav am-nav am-nav-tabs">
            <li><a href="#tab2">请修改车辆基本信息</a></li>
        </ul>

        <div class="am-tabs-bd">
            <div class="am-tab-panel am-fade" id="tab2">
                <form class="am-form" name="storeBicycle">
                    {:token('token')}

                    <div class="am-g am-margin-top">
                        <div class="am-u-sm-2 am-text-right">
                            车号
                        </div>
                        <div class="am-u-sm-4">
                            <input type="text" class="am-input-sm" name="bicycle_number" id="bicycle_number" maxlength="20" required readonly  value="{$bicycleInfo.bicycle_number}">
                        </div>
                        <div class="am-u-sm-6">*必填，不可重复</div>
                    </div>
                    <div class="am-g am-margin-top">
                        <div class="am-u-sm-2 am-text-right">
                            车号
                        </div>
                        <div class="am-u-sm-4">
                            <input type="text" class="am-input-sm" name="bicycle_name" id="bicycle_name" maxlength="20" required readonly  value="{$bicycleInfo.bicycle_name}">
                        </div>
                        <div class="am-u-sm-6">*必填，不可重复</div>
                    </div>

                    <div class="am-g am-margin-top">
                        <div class="am-u-sm-2 am-text-right">
                            锁号
                        </div>
                        <div class="am-u-sm-4">
                            <input type="text" class="am-input-sm" name="lock_number" id="lock_number" maxlength="20" required  value="{$bicycleInfo.lock_number}">
                        </div>
                        <div class="am-u-sm-6">*必填，不可重复</div>
                    </div>

                    <div class="am-g am-margin-top">
                        <div class="am-u-sm-2 am-text-right">
                            状态
                        </div>
                        <div class="am-u-sm-4">
                            <select name="status" id="status">
                                {volist name="bicycleStatus" id="status"}
                                <option value="{$status.value}" {if condition="$status.value eq $bicycleInfo.status"} selected {/if}>{$status.zhDesc}</option>
                                {/volist}
                            </select>
                        </div>
                        <div class="am-u-sm-6">选填</div>
                    </div>

                </form>
            </div>

        </div>
    </div>

    <div class="am-margin">
        <button type="button" class="am-btn am-btn-primary am-btn-xs" id="formSubmit">提交保存</button>
        <button type="button" class="am-btn am-btn-primary am-btn-xs" id="formReset">放弃保存</button>
    </div>
</div>
<!-- content end -->

<script>
    const form = $("form[name='storeBicycle']")[0];
    const submitUrl = "<?php echo url('index/bicycle/update', ['id' => $id]); ?>";
    const formReset = function () {
        form.reset();
    };

    const formSubmit = function () {
        $.ajax({
            url: submitUrl,
            type: 'patch',
            dataType: 'json',
            timeout: 1000,
            async: true,   // 是否异步
            data: {
                'token': $("input[name='token']").val(),
                'lock_number': $('#lock_number').val(),
                'status': $('#status').val()
            },
            success: function (data, status) {
                var responseStatus = data.status;
                if (!responseStatus) {
                    alertSuccessMsg(responseStatus, "<?php echo url('index/bicycle/index') ; ?>");
                } else {
                    alertErrMsg(responseStatus, data.msg);
                }
            },
            fail: function (err, status) {
                console.log(err)
            }
        })
    };

    $('#formReset').click(formReset);
    $('#formSubmit').click(formSubmit);
</script>